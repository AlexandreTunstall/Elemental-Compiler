foreign export "main" main
    : (∀ ((∀ 0 → 0 → 0) → (∀ 0 → 0 → 0) → (∀ 0 → 0 → 0) → (∀ 0 → 0 → 0) → 0) → 0)
    → IO (∀ 0 → 0)

foreign import c_dothing "dothing"
    : (∀ ((∀ 0 → 0 → 0) → (∀ 0 → 0 → 0) → (∀ 0 → 0 → 0) → (∀ 0 → 0 → 0) → 0) → 0)
    → IO (∀ 0 → 0)

foreign primitive pureIO : ∀ 0 → IO 0
foreign primitive bindIO : ∀ IO 0 → ∀ (1 → IO 0) → IO 0

main = abort_if_null (λ(∀ ((∀ 0 → 0 → 0) → (∀ 0 → 0 → 0) → (∀ 0 → 0 → 0) → (∀ 0 → 0 → 0) → 0) → 0) bindIO
    @(∀ 0 → 0) (c_dothing 0)
    @(∀ 0 → 0) (λ(∀ 0 → 0) (c_dothing 1)))

abort_if_null = λ((∀ ((∀ 0 → 0 → 0) → (∀ 0 → 0 → 0) → (∀ 0 → 0 → 0) → (∀ 0 → 0 → 0) → 0) → 0) → IO (∀ 0 → 0))
    λ(∀ ((∀ 0 → 0 → 0) → (∀ 0 → 0 → 0) → (∀ 0 → 0 → 0) → (∀ 0 → 0 → 0) → 0) → 0)
    0 @(∀ 0 → 0 → 0) (λ(∀ 0 → 0 → 0) λ(∀ 0 → 0 → 0) λ(∀ 0 → 0 → 0) λ(∀ 0 → 0 → 0)
        or 0 (or 1 (or 2 3))
        ) @(IO (∀ 0 → 0)) (1 0) (pureIO @(∀ 0 → 0) (Λ λ0 0))

or = λ(∀ 0 → 0 → 0) λ(∀ 0 → 0 → 0) 1 @(∀ 0 → 0 → 0) t 0

t = Λ λ0 λ0 1

