-- Verifies that polymorphic functions are shared correctly.

foreign export "main1" main1 : (∀ 0 → 0 → 0) → IO (∀ 0 → 0 → 0)
foreign export "main2" main2 : (∀ ((∀ 0 → 0 → 0) → (∀ 0 → 0 → 0) → 0) → 0) → IO (∀ ((∀ 0 → 0 → 0) → (∀ 0 → 0 → 0) → 0) → 0)

foreign import c_dothing "dothing" : IO (∀ 0 → 0)

foreign primitive pureIO : ∀ 0 → IO 0
foreign primitive bindIO : ∀ IO 0 → ∀ (1 → IO 0) → IO 0

main1 = shared @(∀ 0 → 0 → 0)
main2 = shared @(∀ ((∀ 0 → 0 → 0) → (∀ 0 → 0 → 0) → 0) → 0)

shared = Λ λ0 bindIO
    @(∀ 0 → 0) c_dothing
    @0 (λ(∀ 0 → 0) pureIO @0 1)

